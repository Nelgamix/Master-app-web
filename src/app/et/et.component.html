<div class="container contenu">
  <div class="row">
    <div class="col-6">
      <span *ngIf="adeOnline" style="color: green;">ADE est en ligne!</span>
      <span *ngIf="!adeOnline" style="color: red;">ADE est hors-ligne!</span>
      <span style="font-weight: bold;">&nbsp;Dernière mise à jour {{lastUpdated | date:'dd-MM-y HH:mm'}}</span>
    </div>

    <div class="col-6">
      <form class="form-inline" id="form-selection-date">
        <label for="selDate" class="mr-2">Sélection de la semaine</label>
        <select [(ngModel)]="selectedDate" (ngModelChange)="onChangeDate($event)" class="custom-select" name="selDate" id="selDate">
          <option [ngValue]="i" *ngFor="let i of dates">{{i.debut}} &rarr; {{i.fin}}</option>
        </select>
      </form>
    </div>
  </div>

  <div *ngIf="!ok" style="margin-top: 70px; text-align: center;">
    <h2>ADE est hors-ligne, et les données n'ont pas été enregistrées sur la BD, donc retente plus tard&hellip;</h2>
    <h3 class="text-muted">Peut être que le chargement depuis le serveur a échoué, essaye d'actualiser la page si tu viens d'arriver</h3>
  </div>

  <div *ngIf="ok" style="margin-top: 10px;">
    <div class="row">
      <div class="col-7 heading">
        <div class="row">
          <div class="col-4">
            <h5>Statistiques</h5>
            <div class="row">
              <div class="col-12">
                <span class="stat-donnee">{{stats.total}}</span> heures
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <span class="stat-donnee">{{stats['moyenne-cours']}}</span> heure(s) / cours
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <span class="stat-donnee">{{stats['moyenne-semaine']}}</span> heures / jour
              </div>
            </div>
          </div>
          <div class="col-4">
            <h5>Vue</h5>
            <div class="btn-group" ngbRadioGroup name="radioBasic" [(ngModel)]="vueType">
              <label ngbButtonLabel class="btn-primary">
                <input ngbButton type="radio" [value]="1"> Tables
              </label>
              <label ngbButtonLabel class="btn-primary">
                <input ngbButton type="radio" [value]="2"> Visuel
              </label>
            </div>
          </div>
          <div class="col-4">
            <h5>Exclusions</h5>
            <div class="row" *ngFor="let e of exclusions">
              <div class="col-12">
                {{e.type}}: {{e.contient}}
              </div>
            </div>
            <div class="row">
              <div class="col">
                <button class="btn btn-warning take-width" (click)="openExclusions()">Configurer</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-4 heading">
        <h5>Début &amp; fin des cours</h5>
        <table style="width: 75%; margin: auto;">
          <tbody>
            <ng-container *ngFor="let j of emploiTempsService.emploiTemps.jours">
              <tr *ngIf="j">
                <td><span class="stat-titre">{{j.nom}}</span></td>
                <td><span class="stat-donnee">{{j.premierCours.debut | date: 'HH:mm'}} &rarr; {{j.dernierCours.fin | date: 'HH:mm'}}</span></td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>

    <ng-container [ngSwitch]="vueType">
      <et-table *ngSwitchCase="1"></et-table>
      <et-visuel *ngSwitchCase="2"></et-visuel>
    </ng-container>
  </div>
</div>

<div class="loader" *ngIf="loading">
  <h1>Chargement...</h1>
</div>
